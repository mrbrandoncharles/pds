#!/bin/bash

# Set environment variables
PDS_HOSTNAME="yourhostname"
PDS_DATADIR="/path/to/datadirectory"
PDS_ADMIN_EMAIL="admin@example.com"
PDS_DID_PLC_URL="yourdidplcurl"
PDS_BSKY_APP_VIEW_URL="yourbskyurl"
PDS_BSKY_APP_VIEW_DID="yourbskydid"
PDS_REPORT_SERVICE_URL="yourreportserviceurl"
PDS_REPORT_SERVICE_DID="yourreportservicedid"
PDS_CRAWLERS="crawler1,crawler2"
PUBLIC_IP="yourpublicip"

# Command for generating secure secrets
GENERATE_SECURE_SECRET_CMD="openssl rand -base64 32"
GENERATE_K256_PRIVATE_KEY_CMD="openssl ecparam -name secp256k1 -genkey -noout -out private_key.pem"

# Generate the secure secrets
PDS_ADMIN_PASSWORD=$(eval "${GENERATE_SECURE_SECRET_CMD}")
PDS_JWT_SECRET=$(eval "${GENERATE_SECURE_SECRET_CMD}")
PDS_PLC_ROTATION_KEY_K256_PRIVATE_KEY_HEX=$(eval "${GENERATE_K256_PRIVATE_KEY_CMD}")

# Create the PDS env config
cat <<PDS_CONFIG >"${PDS_DATADIR}/pds.env"
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_PLC_ROTATION_KEY_K256_PRIVATE_KEY_HEX=${PDS_PLC_ROTATION_KEY_K256_PRIVATE_KEY_HEX}
PDS_DATA_DIRECTORY=${PDS_DATADIR}
PDS_BLOBSTORE_DISK_LOCATION=${PDS_DATADIR}/blocks
PDS_BLOB_UPLOAD_LIMIT=52428800
PDS_DID_PLC_URL=${PDS_DID_PLC_URL}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_REPORT_SERVICE_DID=${PDS_REPORT_SERVICE_DID}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_ADMIN_EMAIL=${PDS_ADMIN_EMAIL}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_CONFIG_ENABLED=true
PDS_DEBUG=true
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_BLOBSTORE_DISK_LOCATION=${PDS_DATADIR}/blocks
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_CONFIG_ENABLED=true
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_ADMIN_EMAIL=${PDS_ADMIN_EMAIL}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_REPORT_SERVICE_DID=${PDS_REPORT_SERVICE_DID}
PDS_BLOBSTORE_DISK_LOCATION=${PDS_DATADIR}/blocks
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_CONFIG_ENABLED=true
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_REPORT_SERVICE_DID=${PDS_REPORT_SERVICE_DID}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_BLOBSTORE_DISK_LOCATION=${PDS_DATADIR}/blocks
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_CONFIG_ENABLED=true
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_ADMIN_EMAIL=${PDS_ADMIN_EMAIL}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_DEBUG=true
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_CONFIG_ENABLED=true
PDS_ADMIN_EMAIL=${PDS_ADMIN_EMAIL}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_CONFIG_ENABLED=true
PDS_BLOBSTORE_DISK_LOCATION=${PDS_DATADIR}/blocks
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_REPORT_SERVICE_DID=${PDS_REPORT_SERVICE_DID}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_DEBUG=true
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_BLOBSTORE_DISK_LOCATION=${PDS_DATADIR}/blocks
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_ADMIN_EMAIL=${PDS_ADMIN_EMAIL}
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_ADMIN_EMAIL=${PDS_ADMIN_EMAIL}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_BLOBSTORE_DISK_LOCATION=${PDS_DATADIR}/blocks
PDS_DEBUG=true
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_REPORT_SERVICE_DID=${PDS_REPORT_SERVICE_DID}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_ADMIN_EMAIL=${PDS_ADMIN_EMAIL}
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_ADMIN_EMAIL=${PDS_ADMIN_EMAIL}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_CONFIG_ENABLED=true
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_BLOBSTORE_DISK_LOCATION=${PDS_DATADIR}/blocks
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_CONFIG_ENABLED=true
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_BLOBSTORE_DISK_LOCATION=${PDS_DATADIR}/blocks
PDS_DEBUG=true
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_REPORT_SERVICE_DID=${PDS_REPORT_SERVICE_DID}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_REPORT_SERVICE_DID=${PDS_REPORT_SERVICE_DID}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_ADMIN_EMAIL=${PDS_ADMIN_EMAIL}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_CONFIG_ENABLED=true
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_ADMIN_EMAIL=${PDS_ADMIN_EMAIL}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_REPORT_SERVICE_DID=${PDS_REPORT_SERVICE_DID}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_CONFIG_ENABLED=true
PDS_REPORT_SERVICE_DID=${PDS_REPORT_SERVICE_DID}
PDS_ADMIN_EMAIL=${PDS_ADMIN_EMAIL}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_DATABASE_URL=sqlite:///${PDS_DATADIR}/pds.sqlite
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_ADMIN_EMAIL=${PDS_ADMIN_EMAIL}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_ADMIN_EMAIL=${PDS_ADMIN_EMAIL}
PDS_REPORT_SERVICE_DID=${PDS_REPORT_SERVICE_DID}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_ADMIN_EMAIL=${PDS_ADMIN_EMAIL}
PDS_PUBLIC_IP=${PUBLIC_IP}
PDS_BSKY_APP_VIEW_URL=${PDS_BSKY_APP_VIEW_URL}
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_REPORT_SERVICE_URL=${PDS_REPORT_SERVICE_URL}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_BSKY_APP_VIEW_URL_PDS_ROLE_ADMIN=true
PDS_JWT_SECRET=${PDS_JWT_SECRET}
PDS_HOSTNAME=${PDS_HOSTNAME}
PDS_CRAWLERS=${PDS_CRAWLERS}
PDS_ADMIN_PASSWORD=${PDS_ADMIN_PASSWORD}
PDS_BSKY_APP_VIEW_DID=${PDS_BSKY_APP_VIEW_DID}
PDS_DATABASE_URL=sqlite:///${PDS_DATAD
